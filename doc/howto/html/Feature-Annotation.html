<?xml version="1.0" encoding="ISO-8859-1"?>
<!DOCTYPE html
  PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"><head><title>Feature and Annotation HOWTO</title><link rel="stylesheet" href="e-novative.css" type="text/css"/><meta name="generator" content="DocBook XSL Stylesheets V1.55.0"/><meta name="description" content="&#xA;	This is a HOWTO written in DocBook format that explains how to&#xA;	use the SeqFeature and Annotation objects of Bioperl. &#xA;      "/></head><body><div xmlns="" id="customheader"><span class="logo"></span>
    
    </div><div class="article"><div class="titlepage"><div><h1 class="title"><a id="d3e1"/>Feature and Annotation HOWTO</h1></div><div><div class="author"><h3 class="author">Brian Osborne</h3><div class="affiliation"><span class="orgname">
	  <a href="http://www.cognia.com" target="_top">Cognia Corporation</a>
	<br/></span><div class="address"><p>
	  <tt>&lt;<a href="mailto:brian_osborne-at-cognia.com">brian_osborne-at-cognia.com</a>&gt;</tt>
        </p></div></div></div></div><div><div class="legalnotice"><p>
	This document is copyright Brian Osborne, 2003. For
	reproduction other than personal use please contact brian at 
	cognia.com
      </p></div></div><div><p class="pubdate">2003-10-14</p></div><div><div class="abstract"><p class="title"><b>Abstract</b></p><p>
	This is a HOWTO written in DocBook format that explains how to
	use the SeqFeature and Annotation objects of Bioperl. 
      </p></div></div><hr/></div><div class="toc"><p><b>Table of Contents</b></p><dl><dt>1. <a href="#introduction">Introduction</a></dt><dt>2. <a href="#basics">The Basics</a></dt><dt>3. <a href="#feat_from_genbank">Features from Genbank</a></dt><dt>4. <a href="#other_objects">Other objects</a></dt><dt>5. <a href="#anno_from_genbank">Annotations from Genbank</a></dt><dt>6. <a href="#direct">Directly from the Sequence object</a></dt><dt>7. <a href="#location">Location Objects</a></dt><dt>8. <a href="#annotation">Building your own annotated sequences</a></dt><dt>9. <a href="#annotation_variations">The different Annotation objects</a></dt><dt>10. <a href="#in_addition">Additional Information</a></dt><dt>11. <a href="#acknowledgements">Acknowledgements</a></dt></dl></div><div class="section"><div class="titlepage"><div><h2 class="title" style="clear: both"><a id="introduction"/>1. Introduction</h2></div></div><p>
      There's no more central notion in bioinformatics than the idea that
      portions of protein or nucleotide sequence have specific
      characteristics. A given stretch of DNA may have been found
      to be essential for the proper transcriptional regulation of a
      gene, or a particular amino acid sequence may bind a particular
      ion. This simple idea turns out to be a bit more complicated
      in the bioinformatics world where there's a need to represent the actual
      data in all its varied forms. The promoter region may not be precisely
      defined down to the base pair, a transcribed region may be divided into
      discontinuous exons, a gene may have different numbered positions on
      different maps, a sequence may have a sub-sequence which itself
      possesses some characteristic, an experimental observation may be
      associated with a literature reference, and so on. This HOWTO
      describes aspects of Bioperl's approach. The problem is how to
      create software that accepts, analyzes, and displays any and all of
      this sequence annotation with the required attention to detail
      yet remains flexible and easy to use. The general names for the
      modules or objects that serve these purposes in Bioperl are
      SeqFeature and Annotation.
    </p><p>
      This HOWTO will discuss these objects and the differences
      between them. I'll also show how to parse 
      files with these objects and discuss the basics of how to annotate sequence
      using the objects. 
    </p></div><div class="section"><div class="titlepage"><div><h2 class="title" style="clear: both"><a id="basics"/>2. The Basics</h2></div></div><p>
      Some Bioperl neophytes may also be new to object-oriented
      programming (OOP) and this notion of an object. OOP is not the
      subject of this HOWTO but I do want to show how objects are
      used in Bioperl. In the object-oriented world parsing a
      Genbank file doesn't give you data, it gives you objects and you
      can ask the object, a variable, for data. While annotating you don't create a
      file or database entry directly. You might create a "sequence
      object" and an "annotation object", then put these two
      together to create an "annotated sequence object". You could then tell
      this object to make a version of itself as a file, or pass this
      object to a "database object" for entry. In a sense a
      bit more complicated but in another way very flexible and
      logical, since each kind of data is treated independently.
    </p><p>
      The Bioperl authors use Perl in an object-oriented way so each
      module, or object, inherits at least some of its capabilities from
      another object, a parent. The OOP approach also allows new modules to 
      modify or add functionality, distinct from the parent. Practically
      speaking this means that there's not one definitive SeqFeature
      or Annotation object but many, each a variation on a theme. The
      details of the these varieties will be discussed in other sections, but for now
      we could use some broad definitions that apply to all the variations. 
    </p><p>
      A SeqFeature object is associated with a sequence, and can have
      a location on that sequence - it's a way of describing the
      characteristics of a specific part of a sequence. SeqFeature objects 
      can also have features themselves, which you
      could call sub-features but which, in fact, are complete
      SeqFeature objects. SeqFeature objects can also have one or more
      Annotations associated with them.
    </p><p>
      An Annotation object is also associated with a sequence, of
      course, but it does not have a location on the sequence, so it's
      associated with an entire sequence. This is one of the
      important differences between a SeqFeature and an
      Annotation. Annotations also can't have SeqFeatures, which makes
      sense since SeqFeature objects typically have locations. The relative
      simplicity of the Annotation has made it
      amenable to the creation of a useful set of Annotation objects,
      each devoted to a particular kind of observation or attribute.
    </p><p>
      I mentioned locations, above. Describing locations can be
      complicated in certain situations, say when some feature is
      located on different sequences with varying degrees of
      precision. One location could also be shared
      between disparate objects, such as two different kinds of 
      SeqFeatures. Because of these sorts of complexities and because
      one may want to create different types of locations the Bioperl 
      authors elected to keep location functionality inside dedicated 
      Location objects.
    </p><p>
      SeqFeatures and Annotations will make the most sense if you're
      already somewhat familiar with Bioperl and its central Seq
      and SeqIO objects. The reader is referred to the 
      <a href="http://bioperl.org/Core/Latest/bptutorial.html" target="_top">bptutorial</a>, 
      the module documentation, and the 
      <a href="http://bioperl.org/HOWTOs/html/SeqIO.html" target="_top">SeqIO HOWTO</a> 
      for more information on these topics. Here's a bit of code, to summarize:
      <pre class="programlisting">
	# BAB55667.gb is a Genbank file
	use Bio::SeqIO;
	my $seqio_object = Bio::SeqIO-&gt;new(-file =&gt; "BAB55667.gb );
	my $seq_object = $seqio_object-&gt;next_seq;
      </pre>
    </p><div class="note"><table border="0" summary="Note"><tr><td rowspan="2" align="center" valign="top" width="25"><img alt="[Note]" src="images/note.png"/></td><th>Note</th></tr><tr><td colspan="2" align="left" valign="top">
      This object, <tt>$seq_object</tt>, is actually a
      <tt>Bio::Seq::RichSeq</tt> 
      object - can a PrimarySeq object, the simple parent of all Sequence objects, 
      have a feature or an annotation? No. 
    </td></tr></table></div><p>
      Now that we have a sequence object in hand we can examine its 
      features and annotations.
    </p></div><div class="section"><div class="titlepage"><div><h2 class="title" style="clear: both"><a id="feat_from_genbank"/>3. Features from Genbank</h2></div></div><p>
      When the file comes from Genbank it's easy to see where most of the
      features are, they're in the Feature table section, something
      like this:
      <pre class="programlisting">
FEATURES             Location/Qualifiers
     source          1..1846
                     /organism="Homo sapiens"
                     /db_xref="taxon:9606"
                     /chromosome="X"
                     /map="Xp11.4"
     gene            1..1846
                     /gene="NDP"
                     /note="ND"
                     /db_xref="LocusID:4693"
                     /db_xref="MIM:310600"
     CDS             409..810
                     /gene="NDP"
                     /note="Norrie disease (norrin)"
                     /codon_start=1
                     /product="Norrie disease protein"
                     /protein_id="NP_000257.1"
                     /db_xref="GI:4557789"
                     /db_xref="LocusID:4693"
                     /db_xref="MIM:310600"
                     /translation="MRKHVLAASFSMLSLLVIMGDTDSKTDSSFIMDSDPRRCMRHHY
                     VDSISHPLYKCSSKMVLLARCEGHCSQASRSEPLVSFSTVLKQPFRSSCHCCRPQTSK
                     LKALRLRCSGGMRLTATYRYILSCHCEECNS"
      </pre>
      Features in Bioperl are accessed using their tags, either a
      "primary tag" or a plain "tag". Examples of primary tags in this 
      text are "source", "gene", and "CDS". Plain tags include
      "organism", "note", "db_xref", and "translation".
    </p><p>
      When a Genbank file like this is parsed the
      feature data is converted into objects, specifically a 
      <tt>Bio::SeqFeature::Generic</tt> object. In the other parts of
      the Bioperl documentation one finds discussions
      of the "SeqFeature object", but there's more
      than one of these, so what is this a reference to? More
      than likely it's referring to this same 
      <tt>Bio::SeqFeature::Generic</tt>
      object. Think of it as the default SeqFeature object. Now,
      should you care what kind of object is being made? For the most 
      part, no, you can write lots of useful and powerful Bioperl code
      without ever knowing these specific details.
    </p><div class="tip"><table border="0" summary="Tip"><tr><td rowspan="2" align="center" valign="top" width="25"><img alt="[Tip]" src="images/tip.png"/></td><th>Tip</th></tr><tr><td colspan="2" align="left" valign="top">
	By the way, how does one know what kind of object one has in hand? Try
	something like:
	<pre class="programlisting">
	  print ref($seq_object);
	  # results in "Bio::Seq::RichSeq"
	</pre></td></tr></table></div><p>
      The SeqFeature::Generic object uses tag/value pairs to store information,
      and the values are always returned as arrays. A simple
      way to access all the data in the features of a Seq object would
      look something like this: 
      <pre class="programlisting">
	foreach my $feat_object ($seq_object-&gt;get_SeqFeatures) {
	   print "primary tag: ", $feat_object-&gt;primary_tag, "\n";
	   foreach my $tag ($feat_object-&gt;get_all_tags) {
	      print "  tag: ", $tag, "\n";
	      foreach my $value ($feat_object-&gt;get_tag_values($tag)) {
	         print "    value: ", $value, "\n";
	      }
	   }
	}
      </pre>
      This bit would print out something like:
      <pre class="programlisting">
primary tag: source
  tag: chromosome
    value: X
  tag: db_xref
    value: taxon:9606
  tag: map
    value: Xp11.4
  tag: organism
    value: Homo sapiens
primary tag: gene
  tag: gene
    value: NDP
  tag: note
    value: ND
primary tag: CDS
  tag: codon_start
    value: 1
  tag: db_xref
    value: GI:4557789
    value: LocusID:4693
    value: MIM:310600
  tag: product
    value: Norrie disease protein
  tag: protein_id
    value: NP_000257.1
  tag: translation
    value: MRKHVLAASFSMLSLLVIMGDTDSKTDSSFIMDSDPRRCMRHHYVDSI
           SHPLYKCSSKMVLLARCEGHCSQASRSEPLVSFSTVLKQPFRSSCHCC
           RPQTSKLKALRLRCSGGMRLTATYRYILSCHCEECNS
      </pre>
    </p><p>
    So to retrieve specific values, like all the database identifiers, 
    you could do:
    <pre class="programlisting">
      foreach my $feat_object ($seq_object-&gt;get_SeqFeatures) {
         push @ids,$feat_object-&gt;get_tag_values("db_xref") 
              if ($feat_object-&gt;has_tag("db_xref"));
      }
    </pre>
    </p><div class="important"><table border="0" summary="Important"><tr><td rowspan="2" align="center" valign="top" width="25"><img alt="[Important]" src="images/important.png"/></td><th>Important</th></tr><tr><td colspan="2" align="left" valign="top">
      Make sure to include that "if ($feat_object-&gt;has_tag(&lt;tag&gt;))"
      part, otherwise you'll get errors when the feature does not
      have the tag you're requesting.
    </td></tr></table></div><p>
      One commonly asked question is "How do I get the sequence of a
      SeqFeature?" The answer is "it depends on what you're looking
      for". If you'd like the sequence of the parent, the sequence
      object that the SeqFeature is associated with, then use 
      <tt>entire_seq()</tt>:
      <pre class="programlisting">
	$seq_object = $feat_object-&gt;entire_seq;
      </pre>
      This doesn't return the parent's sequence directly but rather
      a <tt>Bio::PrimarySeq</tt> object corresponding to the parent
      sequence. Now that you have this object you can call its
      <tt>seq()</tt> method to get the sequence string, or
      you could do this all in one step:      
      <pre class="programlisting">
	my $sequence_string = $feat_object-&gt;entire_seq-&gt;seq;
      </pre>
      There are 2 other useful methods, <tt>seq()</tt> and
      <tt>spliced_seq()</tt>. Consider the following
      Genbank example:
      <pre class="programlisting">
FEATURES             Location/Qualifiers
     source          1..177
                     /organism="Mus musculus"
                     /mol_type="genomic DNA"
                     /db_xref="taxon:10090"
     tRNA            join(103..111,121..157)
                     /gene="Phe-tRNA"
      </pre>
      To get the sequence string from the start to the end of the tRNA
      feature use <tt>seq()</tt>. To get the spliced
      sequence string, accounting for the start and end locations of 
      each sub-sequence, use <tt>spliced_seq()</tt>. Here
      are the methods and the corresponding example coordinates:
    </p><div class="table"><a id="d3e62"/><table summary="Sequence string methods" border="1"><colgroup><col/><col/></colgroup><thead><tr><th>Method</th><th>Coordinates</th></tr></thead><tbody><tr><td>entire_seq()</td><td>1..177</td></tr><tr><td>seq()</td><td>103..157</td></tr><tr><td>spliced_seq()</td><td>103..111,121..157</td></tr></tbody></table><p class="title"><b>Table 1. Sequence string methods</b></p></div><p>
      It's not unusual for a Genbank file to have multiple CDS or gene
      features (and recall that 'CDS' or 'gene' could be primary tags
      in Bioperl), each with a number of tags, like 'note', 'protein_id',
      or 'product'. How can we get, say, the nucleotide sequences and gene
      names from all these CDS features? By putting all of this together we
      arrive at something like:
      <pre class="programlisting">
        my $seqio_object = Bio::SeqIO-&gt;new(-file =&gt; $gb_file);
        my $seq_object = $seqio_object-&gt;next_seq;

	foreach my $feat_object ($seq_object-&gt;get_SeqFeatures) {
	  if ($feat_object-&gt;primary_tag eq "CDS") {
	    print $feat_object-&gt;spliced_seq-&gt;seq,"\n";
	    # e.g. 'ATTATTTTCGCTCGCTTCTCGCGCTTTTTGAGATAAGGTCGCGT...'
	    foreach my $val ($feat-&gt;get_tag_values('gene')) {
	      print "gene: ",$val,"\n";
	      # e.g. 'NDP', from a line like '/gene="NDP"'
            }
	}
      </pre> 
    </p><p>
      Many people wouldn't write code in the rather deliberate style
      I've used above. The following is a more compact code
      that gets all the features with a primary tag of 'CDS',
      starting with a Genbank file:
      <pre class="programlisting">
	my @cds_features = grep { $_-&gt;primary_tag eq 'CDS' }
	Bio::SeqIO-&gt;new(-file =&gt; $gb_file)-&gt;next_seq-&gt;get_SeqFeatures;
      </pre>
      With this array of SeqFeatures you could do all sorts of
      useful things, such as find all the values for
      the 'gene' tags and their corresponding spliced nucleotide
      sequences and store them in a hash:
      <pre class="programlisting">
	my %gene_sequences = map {$_-&gt;get_tag_values('gene'),
	                          $_-&gt;spliced_seq-&gt;seq } @cds_features;
      </pre>
      Because you're asking for a specific primary tag and tag, 'CDS'
      and 'gene' respectively, this would only work when there are 
      features that looked something like this:
      <pre class="programlisting">
     CDS             735..1829
                     /gene="MG001"
                     /codon_start=1
                     /product="DNA polymerase III, subunit beta (dnaN)"
                     /protein_id="AAC71217.1"
                     /translation="MNNVIISNNKIKPHHSYFLIEAKEKEINFYANNEYFSVKCNLNK
                     NIDILEQGSLIVKGKIFNDLINGIKEEIITIQEKDQTLLVKTKKTSINLNTINVNEFP
                     RIRFNEKNDLSEFNQFKINYSLLVKGIKKIFHSVSNNREISSKFNGVNFNGSNGKEIF
                     LEASDTYKLSVFEIKQETEPFDFILESNLLSFINSFNPEEDKSIVFYYRKDNKDSFST
                     EMLISMDNFMISYTSVNEKFPEVNYFFEFEPETKIVVQKNELKDALQRIQTLAQNERT
                     FLCDMQINSSELKIRAIVNNIGNSLEEISCLKFEGYKLNISFNPSSLLDHIESFESNE
                     INFDFQGNSKYFLITSKSEPELKQILVPSR"
      </pre>
    </p><p>
      One last note on Genbank features. The Bioperl parsers for Genbank and EMBL are
      built to respect the specification for the feature tables agreed
      upon by Genbank, EMBL, and DDBJ (see <a href="http://www.ncbi.nlm.nih.gov/projects/collab/FT/" target="_top">Feature
      Table Definition</a> for the details). Check this page if
      you're interested in a complete listing and description of all the 
      Genbank, EMBL, and DDBJ feature tags.
    </p><p>
      Despite this specification some non-standard feature descriptors 
      have crept into Genbank, like "bond". When the Bioperl Genbank 
      parser encounters a non-standard
      feature like this it's going to throw a fatal exception. The 
      work-around is to use eval{} so you don't die, something like:
      <pre class="programlisting">
	use Bio::SeqIO;
	my $seq_object;
	my $seqio_object = Bio::SeqIO-&gt;new(-file   =&gt; $gb_file,
                                           -format =&gt; "genbank");
	eval { $seq_object = $seqio_object-&gt;next_seq; };
	# if there's an error
	print "Problem in $gb_file. Bad feature perhaps?\n" if $@;
      </pre>
    </p></div><div class="section"><div class="titlepage"><div><h2 class="title" style="clear: both"><a id="other_objects"/>4. Other objects</h2></div></div><p>
      As an aside I should mention that certain data
      associated in a Genbank file is accessible both 
      as a feature and through a specialized object. Taxonomic 
      information on a sequence, below, can be accessed 
      through a Species object as well as a value to the "organism"
      tag, and you'll get more information from the 
      <tt>Bio::Species object</tt>.
      <pre class="programlisting">
SOURCE      human.
  ORGANISM  Homo sapiens
            Eukaryota; Metazoa; Chordata; Craniata; Vertebrata; Euteleostomi;
            Mammalia; Eutheria; Primates; Catarrhini; Hominidae; Homo.
      </pre>
      You can create this Species object and use its methods or you can
      use the Perlish shorthand:
      <pre class="programlisting">
	# legible and long
	my $species_object = $seq_object-&gt;species;
	my $species_string = $species_object-&gt;species;
	# Perlish
	my $species_string = $seq_object-&gt;species-&gt;species;
	# either way $species_string is "Homo sapiens"
	my $classification = $seq_object-&gt;species-&gt;classification;
	# "sapiens Homo Hominidae Catarrhini Primates Eutheria Mammalia
	# Euteleostomi Vertebrata Craniata Chordata Metazoa Eukaryota"
      </pre>
      The reason that ORGANISM isn't treated only as a plain tag is that
      there are a variety of things one would want to do with
      taxonomic information, so returning just an array wouldn't
      suffice. See the documentation on
      <tt>Bio::Species</tt> for more information.
    </p></div><div class="section"><div class="titlepage"><div><h2 class="title" style="clear: both"><a id="anno_from_genbank"/>5. Annotations from Genbank</h2></div></div><p>
      There's still quite a bit of data left our Genbank files that's
      not in a SeqFeature, and much of it is parsed into Annotation objects. 
      In order to get access to these objects we can get an
      AnnotationCollection object, which is exactly what it sounds like:
      <pre class="programlisting">
	my $io = Bio::SeqIO-&gt;new(-file =&gt; $file, -format =&gt; "genbank" );
	my $seq_obj = $io-&gt;next_seq;
	my $anno_collection = $seq_obj-&gt;annotation;
      </pre>
      Now we can access each Annotation in the AnnotationCollection
      object. The Annotation objects can be retrieved in arrays: 
      <pre class="programlisting">
	foreach my $key ( $anno_collection-&gt;get_all_annotation_keys ) {
	  my @annotations = $anno_collection-&gt;get_Annotations($key);
	  foreach my $value ( @annotations ) {
	    print "tagname : ", $value-&gt;tagname, "\n";
	    # $value is an Bio::Annotation, and has an "as_text" method
	    print "  annotation value: ", $value-&gt;as_text, "\n";
	  }
	}
      </pre>    
      It turns out the value of <tt>$key</tt>, above, and 
      $value-&gt;tagname are the same. The code will print something like:
      <pre class="programlisting">
tagname : comment
  annotation value: Comment: REVIEWED REFSEQ: This record has been curated by
NCBI staff. The reference sequence was derived from X65882.1. Summary: NDP is the
genetic locus identified as harboring mutations that result in Norrie disease.
tagname : reference
  annotation value: Reference: The molecular biology of Norrie's disease
tagname : date_changed
  annotation value: Value: 31-OCT-2000
      </pre>
      If you only wanted a specific annotation, like COMMENT, you
      could do:
      <pre class="programlisting">
	my @annotations = $anno_collection-&gt;get_Annotations('comment');
      </pre>
    </p><p>
      The following is a list of some of the common Annotations and
      what they're derived from in Genbank files: 
    </p><div class="table"><a id="d3e105"/><table summary="Annotation Keys" border="1"><colgroup><col/><col/><col/><col/></colgroup><thead><tr><th>Genbank Text</th><th>Key</th><th>Object Type</th><th>Note</th></tr></thead><tbody><tr><td>COMMENT</td><td>comment</td><td>Comment</td><td> </td></tr><tr><td>SEGMENT</td><td>segment</td><td>SimpleValue</td><td>e.g.
	  "1 of 2"</td></tr><tr><td>ORIGIN</td><td>origin</td><td>SimpleValue</td><td>e.g.
	  "X Chromosome."</td></tr><tr><td>REFERENCE</td><td>reference</td><td>Reference</td><td> </td></tr><tr><td>INV</td><td>date_changed</td><td>SimpleValue</td><td>e.g.
	  "08-JUL-1994"</td></tr><tr><td>KEYWORDS</td><td>keyword</td><td>SimpleValue</td><td> </td></tr><tr><td>ACCESSION</td><td>secondary_accession</td><td>SimpleValue</td><td>2nd
	  of 2 accessions</td></tr></tbody></table><p class="title"><b>Table 2. Annotation Keys</b></p></div><p>
      Some Annotation objects, like Reference, make use of a
      <tt>hash_tree()</tt> method, which returns a hash 
      reference. This is a more thorough way to look at the actual
      values than the <tt>as_text()</tt> 
      method used above. For example, <tt>as_text()</tt>
      for a Reference object is only going to return the title of the 
      reference, whereas the keys of the hash from
      <tt>hash_tree()</tt> will be "title", "authors",
      "location", "medline", "start", and "end".
    <pre class="programlisting">
	if ($value-&gt;tagname eq "reference") {
	  my $hash_ref = $value-&gt;hash_tree;
	  foreach my $key (keys %{$hash_ref}) {
	    print $key,": ",$ref-&gt;{$key},"\n";
	  }
	}
    </pre>
      Which yields:
    <pre class="programlisting">
authors: Meitinger,T., Meindl,A., Bork,P., Rost,B., Sander,C., Haasemann,M. and
Murken,J.
location: Nat. Genet. 5 (4), 376-380 (1993)
medline: 94129616
title: Molecular modelling of the Norrie disease protein predicts a cystine knot
 growth factor tertiary structure
end: 1846
start: 1
    </pre>
    Other Annotation objects, like SimpleValue, also have a
    <tt>hash_tree()</tt> method but the hash isn't
    populated with data and <tt>as_text()</tt> will suffice.
    </p><p>
      The simplest bits of text, like KEYWORDS, end up in these
      Annotation::SimpleValue objects, the COMMENT ends up in a
      <tt>Bio::Annotation::Comment</tt> object, and 
      references are tranformed into
      <tt>Bio::Annotation::Reference</tt> objects. Some of 
      these specialized objects will have specialized methods. Take the 
      Annotation::Reference object, for example:
      <pre class="programlisting">
	if ($value-&gt;tagname eq "reference") {
	  print "author: ",$value-&gt;authors(), "\n";
	}
	# as well as title(), location(), medline(), start(), and end()
      </pre>
    </p></div><div class="section"><div class="titlepage"><div><h2 class="title" style="clear: both"><a id="direct"/>6. Directly from the Sequence object</h2></div></div>
    This is just a reminder that some of the "annotation" data in your sequence
    files can be accessed directly, without looking at SeqFeatures or
    Annotations. For example, if the Sequence object in hand is a Seq::RichSeq
    object then here are some useful methods:
    <div class="table"><a id="d3e165"/><table summary="RichSeq methods" border="1"><colgroup><col/><col/></colgroup><thead><tr><th>Method</th><th>Returns</th></tr></thead><tbody><tr><td>get_secondary_accessions</td><td>array</td></tr><tr><td>keywords</td><td>array</td></tr><tr><td>get_dates</td><td>array</td></tr><tr><td>seq_version</td><td>string</td></tr><tr><td>pid</td><td>string</td></tr><tr><td>division</td><td>string</td></tr></tbody></table><p class="title"><b>Table 3. RichSeq methods</b></p></div>
    These <tt>Bio::Seq::RichSeq</tt> objects are created 
    automatically when you use SeqIO to read from EMBL, GenBank, and 
    SwissProt files. However, it's not guaranteed that each of these
    formats will supply data for all of the methods above.
  </div><div class="section"><div class="titlepage"><div><h2 class="title" style="clear: both"><a id="location"/>7. Location Objects</h2></div></div><p>
      There's quite a bit to this idea of location, so much that it
      probably deserves its own HOWTO. This is my way of saying that
      if this topic interests you should take a closer look at the modules that
      are concerned with both Location and Range. The Range modules
      offer the user a number of useful methods to handle "fuzzy"
      locations, where the "start" and "end" of a particular
      sub-sequence themselves have start and end positions, or are
      only partially defined.
    </p><p>
      In their simplest form the Location objects are used to get or
      set these start and end positions, or the multiple start and end
      positions of "split" locations, like the join statements in the
      CDS feature found in Genbank entries (e.g. "join(45..122,233..267)"):
      <pre class="programlisting">
       foreach my $feature ($seqobj-&gt;top_SeqFeatures){
         if ( $feature-&gt;location-&gt;isa('Bio::Location::SplitLocationI')
                        &amp;&amp; $feature-&gt;primary_tag eq 'CDS' )  {
           foreach my $location ( $feature-&gt;location-&gt;sub_Location ) {
             print $location-&gt;start . ".." . $location-&gt;end . "\n";
           }
         }
       }
      </pre>
    </p></div><div class="section"><div class="titlepage"><div><h2 class="title" style="clear: both"><a id="annotation"/>8. Building your own annotated sequences</h2></div></div><p>
      We've taken a look at getting data from SeqFeature and Annotation
      objects, but what about creating these objects when you
      already have the data? The
      <tt>Bio::SeqFeature::Generic</tt> object is 
      probably the best SeqFeature object for this purpose, in part because of
      its flexibility.
    </p><p>
      <pre class="programlisting">
	use Bio::SeqFeature::Generic;
	# create the feature and add additional data while initializing, 
	# an author and a note
	my $feat = new Bio::SeqFeature::Generic(-start  =&gt; 10,
	                                        -end    =&gt; 22,
					        -strand =&gt; 1,
					        -tag    =&gt; {author =&gt; 'john',
						            note   =&gt; 'TATA box' } );
	</pre>
      The SeqFeature::Generic object offers the user a "tag system" for
      addition of data that's not explicitly accounted for by its
      methods, that's what the "-tag" is for, above.
      If you want to add your own custom data to a feature you could
      use the "-tag" tag or you could add values after the object has 
      been created:
      <pre class="programlisting">
	$feat-&gt;add_tag_value("match1","PF000123 e-7.2");
	$feat-&gt;add_tag_value("match2","PF002534 e-3.1");
	
	my @arr = $feat-&gt;get_all_tags;
	foreach my $tag (@arr) {
	  print $tag,":",$feat-&gt;get_tag_values($tag),"  ";
	}
        # prints out:
	# author:john  match1:PF000123 e-7.2  match2:PF002534 e-3.1  note:TATA box
      </pre>
      Since the value passed to "-tag" could be any kind of scalar,
      like a reference, it's clear that this approach should be able
      handle just about any sort of data.
      </p><p>
      Once the feature is created it can be associated with a sequence:
      <pre class="programlisting">
	# first we want a Sequence object
	my $seq_obj = Bio::Seq-&gt;new(-seq =&gt; "attcccccttataaaattttttttttgaggggtggg");
	# associate the sequence and the feature
	$feat-&gt;attach_seq($seq_obj);
      </pre>
      Once you have a feature you can add annotations to it using an
      AnnotationCollection object:
      <pre class="programlisting">
	$db_link = new Bio::Annotation::DBLink();
	$db_link-&gt;database('dbSNP');
	$db_link-&gt;primary_id('2367');
	$feat-&gt;annotation-&gt;add_Annotation('dblink',$db_link);
    </pre>
      Note that the first argument to
      <tt>add_Annotation()</tt>
      is the tag name, 'dblink'.
    </p></div><p>
    What if you wanted to add an Annotation directly to a sequence?
    This is an operation similar to the one above. Assume you already have
    a sequence object, you'll create the Annotation object and simply
    add the object to the sequence object: 
    <pre class="programlisting">
      # first create an Ontology annotation
      my $annterm = new Bio::Annotation::OntologyTerm(-label =&gt; 'ABC1',
                                                      -tagname =&gt; 'Gene Name');
      $seq_object-&gt;annotation-&gt;add_Annotation($annterm);
    </pre>
    This is an interesting example because the OntologyTerm object was
    created with a tag name, so you don't need to specify it when you use the 
    <tt>add_Annotation()</tt> method.
  </p><div class="section"><div class="titlepage"><div><h2 class="title" style="clear: both"><a id="annotation_variations"/>9. The different Annotation objects</h2></div></div><p>
      There are a number of specialized Annotation objects, each
      designed to accomodate a particular type of data. Here is a
      table showing the existing types.
    </p><div class="table"><a id="d3e214"/><table summary="The different Annotation objects" border="1"><colgroup><col/><col/></colgroup><thead><tr><th>Description</th><th>Object</th></tr></thead><tbody><tr><td>comment</td><td>Bio::Annotation::Comment</td></tr><tr><td>database identifier</td><td>Bio::Annotation::DBLink</td></tr><tr><td>simple fact</td><td>Bio::Annotation::SimpleValue</td></tr><tr><td>generic value</td><td>Bio::Annotation::SimpleValue</td></tr><tr><td>ontology term</td><td>Bio::Annotation::OntologyTerm</td></tr><tr><td>reference</td><td>Bio::Annotation::Reference</td></tr></tbody></table><p class="title"><b>Table 4. The different Annotation objects</b></p></div><p>
      The best way to find out more about a particular Annotation is
      in the module's own documentation. You can access the complete
      module documentation online at 
      <a href="http://doc.bioperl.org/" target="_top">http://doc.bioperl.org/</a>.
    </p></div><div class="section"><div class="titlepage"><div><h2 class="title" style="clear: both"><a id="in_addition"/>10. Additional Information</h2></div></div><p>
      If you would like to learn about representing sequences and 
      features in graphical form take a look at the <a href="http://bioperl.org/HOWTOs/html/Graphics-HOWTO.html" target="_top">Graphics
      HOWTO</a>. The documentation for each of the individual SeqFeature and 
      Annotation modules is also very useful. If you have questions 
      or comments that aren't addressed therein then write the 
      Bioperl community at bioperl-l@bioperl.org.
    </p></div><div class="section"><div class="titlepage"><div><h2 class="title" style="clear: both"><a id="acknowledgements"/>11. Acknowledgements</h2></div></div>
    Thanks to Steven Lembark for comments and neat code discussions.
  </div></div><div xmlns="" id="customfooter">
      
      
      
    </div></body></html>